# Nixpacks configuration for frontend
# Using Node.js 22 because Vite 7 requires Node.js 20.19+ or 22.12+
[phases.setup]
nixPkgs = ["nodejs_22"]

[phases.install]
cmds = ["npm ci"]

[phases.build]
cmds = ["npm run build", "npm install -g serve"]

[start]
# Use 'serve' for production instead of 'vite preview'
# This serves static files without any proxy configuration
# API requests should go directly to backend via VITE_API_URL
# Important: Listen on 0.0.0.0 (all interfaces) for Dokploy/Docker compatibility
cmd = "serve -s dist -l tcp://0.0.0.0:${PORT:-3000}"
